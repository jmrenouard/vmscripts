### CONFIGURATED BY mygenconf.py at 2020-11-15 18:12:04.122201
NBCPU=3
MEM=3048
DISKSIZE=100
DBRIDGE="enp0s4"
Vagrant.configure("2") do |config|
  if Vagrant.has_plugin?("vagrant-vbguest")
    config.vbguest.auto_update = false
  end
    ### CONFIG app1 vm GENERATED BY mygenconf
    config.vm.define "app1" do |app1|
      app1.vm.box = "cloud-image/ubuntu-24.04"
      app1.vm.hostname = 'app1'
      app1.vm.network "private_network", ip: "192.168.56.171"
      app1.vm.network "public_network", type: "dhcp", bridge: DBRIDGE
      app1.hostmanager.enabled = true
      app1.hostmanager.manage_host = false
      app1.hostmanager.manage_guest = true
      app1.hostmanager.ignore_private_ip = false
      app1.hostmanager.include_offline = true
      app1.hostmanager.aliases = %w(app1.localdomain app1.local)

      #app1.vm.synced_folder "/data", "/data", create: true
      #app1.vm.disk :disk, size: "#{DISKSIZE}GB", primary: true
      app1.vm.provider "virtualbox" do |vb|
         vb.name="app1"
         vb.gui = false
         vb.memory = MEM
         vb.cpus = NBCPU
        # --- LIGNE AJOUTÉE ---
         # Désactive le "Nested Paging" pour améliorer la compatibilité ou résoudre des problèmes d'instabilité.
         vb.customize ["modifyvm", :id, "--nestedpaging", "off"]
      end
      app1.vm.provision "shell", path: "provision_generic.sh"
      app1.vm.provision :hostmanager
    end
    ### CONFIG app2 vm GENERATED BY mygenconf
    config.vm.define "app2" do |app2|
      app2.vm.box = "cloud-image/ubuntu-24.04"
      app2.vm.hostname = 'app2'
      app2.vm.network "private_network", ip: "192.168.56.172"
      app2.vm.network "public_network", type: "dhcp", bridge: DBRIDGE
      app2.hostmanager.enabled = true
      app2.hostmanager.manage_host = false
      app2.hostmanager.manage_guest = true
      app2.hostmanager.ignore_private_ip = false
      app2.hostmanager.include_offline = true
      app2.hostmanager.aliases = %w(app2.localdomain app2.local)

      #app2.vm.synced_folder "/data", "/data", create: true
      #app2.vm.disk :disk, size: "#{DISKSIZE}GB", primary: true
      app2.vm.provider "virtualbox" do |vb|
         vb.name="app2"
         vb.gui = false
         vb.memory = MEM
         vb.cpus = NBCPU
        # --- LIGNE AJOUTÉE ---
         # Désactive le "Nested Paging" pour améliorer la compatibilité ou résoudre des problèmes d'instabilité.
         vb.customize ["modifyvm", :id, "--nestedpaging", "off"]
      end
      app2.vm.provision "shell", path: "provision_generic.sh"
      app2.vm.provision :hostmanager
    end

    ### CONFIG app3 vm GENERATED BY mygenconf
    config.vm.define "app3" do |app3|
      app3.vm.box = "cloud-image/ubuntu-24.04"
      app3.vm.hostname = 'app3'
      app3.vm.network "private_network", ip: "192.168.56.173"
      app3.vm.network "public_network", type: "dhcp", bridge: DBRIDGE
      app3.hostmanager.enabled = true
      app3.hostmanager.manage_host = false
      app3.hostmanager.manage_guest = true
      app3.hostmanager.ignore_private_ip = false
      app3.hostmanager.include_offline = true
      app3.hostmanager.aliases = %w(app3.localdomain app3.local)

      #app3.vm.synced_folder "/data", "/data", create: true
      #app3.vm.disk :disk, size: "#{DISKSIZE}GB", primary: true
      app3.vm.provider "virtualbox" do |vb|
         vb.name="app3"
         vb.gui = false
         vb.memory = MEM
         vb.cpus = NBCPU
        # --- LIGNE AJOUTÉE ---
         # Désactive le "Nested Paging" pour améliorer la compatibilité ou résoudre des problèmes d'instabilité.
         vb.customize ["modifyvm", :id, "--nestedpaging", "off"]
      end
      app3.vm.provision "shell", path: "provision_generic.sh"
      app3.vm.provision :hostmanager
    end
    ### CONFIG app4 vm GENERATED BY mygenconf
    config.vm.define "app4" do |app4|
      app4.vm.box = "cloud-image/ubuntu-24.04"
      app4.vm.hostname = 'app4'
      app4.vm.network "private_network", ip: "192.168.56.174"
      app4.vm.network "public_network", type: "dhcp", bridge: DBRIDGE
      app4.hostmanager.enabled = true
      app4.hostmanager.manage_host = false
      app4.hostmanager.manage_guest = true
      app4.hostmanager.ignore_private_ip = false
      app4.hostmanager.include_offline = true
      app4.hostmanager.aliases = %w(app4.localdomain app4.local)

      #app4.vm.synced_folder "/data", "/data", create: true
      #app4.vm.disk :disk, size: "#{DISKSIZE}GB", primary: true
      app4.vm.provider "virtualbox" do |vb|
         vb.name="app4"
         vb.gui = false
         vb.memory = MEM
         vb.cpus = NBCPU
        # --- LIGNE AJOUTÉE ---
         # Désactive le "Nested Paging" pour améliorer la compatibilité ou résoudre des problèmes d'instabilité.
         vb.customize ["modifyvm", :id, "--nestedpaging", "off"]
      end
      app4.vm.provision "shell", path: "provision_generic.sh"
      app4.vm.provision :hostmanager
    end
end
